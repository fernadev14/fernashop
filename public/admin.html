<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard admin</title>
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="stylesheet" href="./css/admin.css">
    <link rel="stylesheet" href="./css/modal.css" />
    <link rel="stylesheet" href="./css/buttons.css">

    <!-- TAILWINDCSS -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style type="text/tailwindcss">@theme {--color-clifford: #da373d;}</style>
</head>

<body>
    <!-- Layout grid global -->
    <div class="min-h-screen bg-gray-100 grid md:grid-cols-[300px_1fr]">

        <!-- ASIDE -->
        <aside id="sidebar"
            class="bg-blue-600 text-white p-4 hidden md:block fixed md:static w-70 md:w-auto h-full z-50">
            <nav id="navAdmin" class="flex flex-col h-full fixed justify-between">
                <div id="tiendaContainer">
                    <h1 class="text-2xl font-bold mb-6 text-center">FernaShop Admin</h1>
                    <div id="admin-welcome" class="mb-4 flex-row-reverse"></div>
                    <button id="btnTienda"
                        class="px-4 py-2 bg-neutral-800 text-white rounded hover:bg-slate-800 text-sm w-full cursor-pointer hidden">
                        Ir a la tienda
                    </button>
                </div>
                <button id="logout-btn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded mb-10 cursor-pointer">
                    Cerrar sesiÃ³n
                </button>
            </nav>
        </aside>

        <!-- Contenido principal -->
        <main class="md:ml-0 ml-0 p-4 md:p-6 w-full">
            <!-- BotÃ³n hamburguesa solo en mÃ³vil -->
            <div class="flex justify-between md:hidden items-start flex-row-reverse">
                <button id="toggleSidebar" class="text-blue-600 text-2xl focus:outline-none flex-none">
                    â˜°
                </button>
                <div class="md:hidden flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold">Dashboard</h2>
                </div>
            </div>

            <!-- CONTENIDO AGREGAR CARRITO-->
            <section id="form-agregar-producto"
                class="w-full bg-white p-4 rounded shadow mb-6 flex flex-col items-center justify-center gap-8 lg:flex-row ">
                <!-- Formulario agregar productos individual -->
                <form id="agregar-producto-form" data-editando="1234" class="space-y-3 w-1/2 ">
                    <h2 class="text-xl font-semibold mb-2">Agregar producto</h2>
                    <input type="text" id="nombre" placeholder="Nombre*" class="w-full border p-2 rounded" required />
                    <input type="text" id="precio" placeholder="Precio*" class="w-full border p-2 rounded" required />
                    <input type="text" id="imagen" placeholder="Imagen URL*" class="w-full border p-2 rounded"
                        required />
                    <input type="text" id="talla" placeholder="Talla*" class="w-full border p-2 rounded" required />
                    <input type="number" id="stock" name="stock" placeholder="Stock*" class="w-full border p-2 rounded"
                        min="0" required />
                    <input type="text" id="description" name="description" placeholder="DescripciÃ³n producto"
                        class="w-full border p-2 rounded" />
                    <select id="genero" class="w-full border p-2 rounded" required>
                        <option value="" disabled selected>SecciÃ³n</option>
                        <option value="hombre">Hombre</option>
                        <option value="mujer">Mujer</option>
                        <option value="tenis">Tenis</option>
                    </select>
                    <button type="submit" id="btn-submit" class="btn-add-prod">
                        <span class="button__text">Add item</span>
                        <span class="button__icon"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                                viewBox="0 0 24 24" stroke-width="2" stroke-linejoin="round" stroke-linecap="round"
                                stroke="currentColor" height="24" fill="none" class="svg">
                                <line y2="19" y1="5" x2="12" x1="12"></line>
                                <line y2="12" y1="12" x2="19" x1="5"></line>
                            </svg></span>
                    </button>
                </form>

                <!-- Formulario agregar productos CSV -->
                <form id="form-importar-productos" class="space-y-3 flex flex-col justify-center items-center">
                    <h2 class="text-xl font-semibold mb-10">Importar productos (CSV)</h2>
                    <button id="descargar-ejemplo" type="button"
                        class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg flex items-center gap-2 mb-20 shadow cursor-pointer">
                        ðŸ“¥ Descargar Plantilla
                    </button>
                    <div class="container my-18">
                        <div class="folder">
                            <div class="front-side">
                                <div class="tip"></div>
                                <div class="cover"></div>
                            </div>
                            <div class="back-side cover"></div>
                        </div>
                        <label class="custom-file-upload">
                            <input type="file" id="archivo-productos" accept=".csv" class="title" required />
                            <span id="nombre-archivo">Elige un archivo</span>
                        </label>
                    </div>

                    <!-- <button type="submit" class="btn-add-prod" id="btn-import-csv">
                        <span class="button__text">Importar</span>
                        <span class="button__icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" stroke-width="2"
                                stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" height="24"
                                fill="none" class="svg">
                                <polyline points="8 17 12 21 16 17"></polyline>
                                <line x1="12" y1="12" x2="12" y2="21"></line>
                                <rect x="4" y="4" width="16" height="4" rx="2"></rect>
                            </svg>
                        </span>
                    </button> -->

                    <!-- Nuevo BotÃ³n Previsualizar -->
                    <button id="previsualizar" type="button"
                        class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg flex items-center gap-2 mt-18 shadow cursor-pointer">
                        Previsualizar
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </button>
                </form>
            </section>

            <!-- CONTENIDO PRODUCTOS -->
            <section class="mb-6">
                <div class="flex justify-between items-center mb-4">
                    <input type="text" id="input-buscar" placeholder="Buscar producto"
                        class="border p-2 rounded w-full max-w-xs">
                    <p id="contador-productos" class="text-gray-600 ml-4">Total: 0 productos</p>
                </div>
                <!-- LOADING -->
                <div id="loader"></div>
                <ul id="lista-productos" class="grid gap-4"></ul>
            </section>
        </main>
    </div>


    <!-- Modal de EdiciÃ³n -->
    <div id="modal-editar" class="hidden fixed inset-0 bg-[rgba(0,0,0,0.85)] flex justify-center items-center z-50">
        <div class="bg-white rounded-lg p-6 shadow max-w-md w-full relative">
            <h2 class="text-xl font-semibold mb-4">Editar Producto</h2>
            <form id="form-editar-producto" class="space-y-3">
                <input type="text" id="inputEditNombre" placeholder="Nombre" class="w-full border p-2 rounded"
                    required />
                <input type="text" id="inputEditPrecio" placeholder="Precio" class="w-full border p-2 rounded"
                    required />
                <input type="text" id="inputEditImagen" placeholder="Imagen URL" class="w-full border p-2 rounded"
                    required />
                <input type="text" id="inputEditTalla" placeholder="Talla" class="w-full border p-2 rounded" required />
                <input type="number" id="inputEditStock" placeholder="Stock*" class="w-full border p-2 rounded" min="0"
                    required />
                <input type="text" id="inputEditDescripcion" placeholder="DescripciÃ³n"
                    class="w-full border p-2 rounded" />
                <select id="inputEditGenero" class="w-full border p-2 rounded" required>
                    <option value="hombre">Hombre</option>
                    <option value="mujer">Mujer</option>
                    <option value="tenis">Tenis</option>
                </select>
                <div class="flex justify-end gap-2">
                    <button type="button" id="btn-cancelar-edicion"
                        class="px-4 py-2 bg-gray-300 rounded cursor-pointer">Cancelar</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded cursor-pointer">Guardar
                        cambios</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Vista Previa CSV -->
    <div id="modal-preview" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-4xl p-6 relative">
            <h2 class="text-xl font-bold mb-4">Vista previa del CSV</h2>

            <div class="overflow-x-auto max-h-[400px] overflow-y-auto border rounded-lg">
                <table id="preview-table" class="w-full text-sm text-left border-collapse">
                    <!-- La tabla se renderiza dinÃ¡micamente -->
                </table>
            </div>

            <div class="flex justify-end gap-3 mt-4">
                <button id="cancelar-preview"
                    class="px-4 py-2 bg-gray-400 text-white rounded-lg hover:bg-gray-500">Cancelar</button>
                <button id="confirmar-importacion"
                    class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer">
                    Confirmar ImportaciÃ³n
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 shadow-lg flex flex-col items-center">
            <!-- SVG animado de carga de productos a base de datos -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="w-16 h-16 mb-4">
                <!-- Fondo de base de datos -->
                <rect x="30" y="15" width="40" height="60" rx="5" fill="#4F46E5" opacity="0.2" />
                <rect x="25" y="10" width="50" height="10" rx="5" fill="#4F46E5" />

                <!-- LÃ­neas de datos entrando a la base de datos -->
                <g class="data-lines">
                    <line x1="10" y1="30" x2="30" y2="30" stroke="#10B981" stroke-width="2" stroke-linecap="round">
                        <animate attributeName="x1" values="10;30;10" dur="1.5s" repeatCount="indefinite" />
                        <animate attributeName="x2" values="30;50;30" dur="1.5s" repeatCount="indefinite" />
                    </line>
                    <line x1="10" y1="40" x2="30" y2="40" stroke="#F59E0B" stroke-width="2" stroke-linecap="round">
                        <animate attributeName="x1" values="10;30;10" dur="1.5s" repeatCount="indefinite"
                            begin="0.2s" />
                        <animate attributeName="x2" values="30;50;30" dur="1.5s" repeatCount="indefinite"
                            begin="0.2s" />
                    </line>
                    <line x1="10" y1="50" x2="30" y2="50" stroke="#EF4444" stroke-width="2" stroke-linecap="round">
                        <animate attributeName="x1" values="10;30;10" dur="1.5s" repeatCount="indefinite"
                            begin="0.4s" />
                        <animate attributeName="x2" values="30;50;30" dur="1.5s" repeatCount="indefinite"
                            begin="0.4s" />
                    </line>
                    <line x1="10" y1="60" x2="30" y2="60" stroke="#8B5CF6" stroke-width="2" stroke-linecap="round">
                        <animate attributeName="x1" values="10;30;10" dur="1.5s" repeatCount="indefinite"
                            begin="0.6s" />
                        <animate attributeName="x2" values="30;50;30" dur="1.5s" repeatCount="indefinite"
                            begin="0.6s" />
                    </line>
                </g>

                <!-- Barras de progreso dentro de la base de datos -->
                <rect x="35" y="25" width="30" height="5" rx="2" fill="#10B981">
                    <animate attributeName="height" values="5;40;5" dur="2s" repeatCount="indefinite" />
                </rect>
                <rect x="45" y="25" width="10" height="5" rx="2" fill="#F59E0B">
                    <animate attributeName="height" values="5;30;5" dur="2s" repeatCount="indefinite" begin="0.3s" />
                </rect>
                <rect x="55" y="25" width="5" height="5" rx="2" fill="#EF4444">
                    <animate attributeName="height" values="5;20;5" dur="2s" repeatCount="indefinite" begin="0.6s" />
                </rect>

                <!-- Icono de verificaciÃ³n que aparece ocasionalmente -->
                <path d="M70,65 L75,70 L85,60" stroke="#10B981" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" fill="none" opacity="0">
                    <animate attributeName="opacity" values="0;1;0" dur="3s" repeatCount="indefinite" begin="1s" />
                </path>
            </svg>

            <p class="text-lg font-semibold text-gray-800">Importando productos...</p>
            <p id="loading-progress" class="text-gray-600 mt-2">Procesando 0 de 0</p>
        </div>
    </div>


    <script type="module" src="./js/auth/admin.js"></script>
    <!-- SWEET ALERT -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.22.4/dist/sweetalert2.all.min.js"></script>
    <!-- SheetJS generar Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</body>

</html>